{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/greet.ts","src/main.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","sayHello","name","divName","greet_1","document","getElementById","innerText","apiInvoke","url","method","body","__awaiter","fetch","JSON","stringify","_a","sent","json","error_1","message","productRules","id","v","toString","Number","isNaN","title","price","category","description","image","size","isFormDataValid","formData","productValidation","forEach","k","Object","keys","filter","then","data","console","log","Array","isArray","addEventListener","preventDefault","stopPropagation","FormData","querySelector","product","extractFormData"],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","export function sayHello(name: string) {\r\n    return `Hello from ${name}`;\r\n}","import {sayHello} from './greet';\r\nimport {RequestType, Product, ProductValidation, ProductKey} from './interface/interface';\r\nfunction showHello(divName: string, name:string) {\r\n    const elt = document.getElementById(divName);\r\n    elt.innerText = sayHello(name);\r\n}\r\nshowHello('greeting', 'Johnny');\r\n\r\nconst apiInvoke = async (url: string, method?:RequestType, body?: Product):Promise<Array<Product> | Product | Error> => {\r\n    try {\r\n        const response = await fetch(url, {\r\n            method,\r\n            body: JSON.stringify(body),\r\n        });\r\n        const data = await response.json();\r\n        return data;\r\n    } catch(error) {\r\n        if (error) { return new Error(error.message); }\r\n    }\r\n}\r\n\r\nconst fetchProducts = ():Promise<Array<Product> | Error> => {\r\n    const url = 'https://fakestoreapi.com/products';\r\n    const result = apiInvoke(url) as Promise<Array<Product> | Error>;\r\n    return result;\r\n}\r\n\r\nfunction getProduct(id:number):Promise<Product | Error> {\r\n    const url = `https://fakestoreapi.com/products/${id}`;\r\n    const result =  apiInvoke(url) as Promise<Product>;\r\n    return result;\r\n}\r\n\r\nconst productRules = {\r\n    id: (v:FormDataEntryValue) => v.toString() !== '' && !Number.isNaN(Number(v)),\r\n    title: (v:FormDataEntryValue) => v.toString() !== '' && v.toString().length < 150,\r\n    price: (v:FormDataEntryValue) => v.toString() !== '' && !Number.isNaN(Number(v.toString())) && Number(v.toString()) > 0,\r\n    category: (v:FormDataEntryValue) => v.toString() !== '' && v.toString().length < 100,\r\n    description: (v:FormDataEntryValue) => v.toString() !== '' && v.toString().length < 5000,\r\n    image: (v:FormDataEntryValue) => v.toString() !== '' && (v as File).size < 1048576, \r\n}\r\n\r\nfunction isFormDataValid(formData:FormData):boolean {\r\n    const productValidation:ProductValidation = {};\r\n    try {\r\n        formData.forEach((v, k:ProductKey) => {\r\n            productValidation[k] = productRules[k](v);\r\n           \r\n        })\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n    return Object.keys(productValidation).filter(v => !v).length <= 0\r\n}\r\n\r\nfunction extractFormData(formData:FormData):Product {\r\n    const product:Product = {};\r\n    try {\r\n        formData.forEach((v, k:ProductKey) => {\r\n            if (k === 'price' || k === 'id') {\r\n                product[k] = Number(v.toString());\r\n            } else {\r\n                product[k] = v.toString();\r\n            }\r\n        })\r\n    } catch(e) {}\r\n    return product;\r\n}\r\n\r\nfunction insertProduct(product:Product):Promise<Product | Error> {\r\n    const url = 'https://fakestoreapi.com/products';\r\n    const result = apiInvoke(url, 'POST', product) as Promise<Product | Error>;\r\n    return result;\r\n}\r\n\r\nfunction updateProduct(product:Product):Promise<Product | Error> {\r\n    const url = `https://fakestoreapi.com/products/${product.id}`;\r\n    const result = apiInvoke(url, 'PUT', product) as Promise<Product | Error>;\r\n    return result;\r\n}\r\n\r\nfunction deleteProduct(id:number):Promise<Product | Error> {\r\n    const url = `https://fakestoreapi.com/products/${id}`;\r\n    const result = apiInvoke(url, 'DELETE') as Promise<Product | Error>;\r\n    return result;\r\n}\r\n\r\n(function() {\r\n    fetchProducts().then(data => {\r\n        if (data instanceof Error) {\r\n            console.log(data.message);\r\n        }else if (Array.isArray(data)) {\r\n            console.log(data);\r\n        }\r\n    });\r\n    \r\n    const productForm = document.getElementById('productForm') as HTMLFormElement;\r\n    productForm.addEventListener('submit', (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const formData = new FormData(document.querySelector('form'));\r\n        console.log(isFormDataValid(formData));\r\n        const product =  isFormDataValid(formData) ? extractFormData(formData) : null;\r\n        if (product) {\r\n            insertProduct(product);\r\n        }\r\n    })\r\n})()"]}